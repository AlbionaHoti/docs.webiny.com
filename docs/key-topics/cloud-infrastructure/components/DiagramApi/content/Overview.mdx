## Description

The diagram gives an overview of the complete cloud infrastructure needed by the Webiny applications that come set up by default with every new Webiny project, which together form the **API** project application. The Webiny applications in question are:

1. Security
2. I18N
3. File Manager
4. Page Builder (with Prerendering Service)
5. Form Builder
6. Headless CMS

In the following text, we briefly cover how each of the default Webiny applications is utilizing the shown cloud infrastructure.

#### 1. Security

Although the Security application does work with multiple identity providers, by default, it works with Amazon Cognito, hence its icon in the lower section of the diagram <diagram-letter>e</diagram-letter>. The identity checks are performed from the GraphQL Server <diagram-letter>C</diagram-letter> and Headless CMS <diagram-letter>D</diagram-letter> Lambda functions.

With Amazon Cognito, the application also extends the GraphQL schema located on the GraphQL Server <diagram-letter>C</diagram-letter> Lambda function.

For storing data, the application relies on Amazon DynamoDB <diagram-letter>F</diagram-letter>.

#### 2. I18N

The I18N application doesn't bring any additional cloud infrastructure resources. It just expands the GraphQL schema with its own types and resolvers, so we can say only the GraphQL Server <diagram-letter>C</diagram-letter> Lambda function <diagram-letter>C</diagram-letter> gets affected by it.

For storing data, the application relies on Amazon DynamoDB <diagram-letter>F</diagram-letter>.

#### 3. File Manager

Besides expanding the GraphQL schema located on the GraphQL Server Lambda function, the File Manager application also brings a couple of Lambda functions for performing file uploads and downloads and also image optimizations. It also brings a single Amazon S3 bucket, in which the files are ultimately stored <diagram-letter>H</diagram-letter>.

For storing data and performing search queries, the application relies on Amazon DynamoDB <diagram-letter>F</diagram-letter> and Amazon ElasticSearch Service <diagram-letter>G</diagram-letter>, respectively.

#### 4. Page Builder (with Prerendering Service)

The Page Builder application doesn't bring any special cloud infrastructure resources, but it does utilize the Prerendering Service which is comprised of four Lambda functions and a CloudWatch event <diagram-letter>I</diagram-letter>. The prerendering HTTP requests are issued over to the public website React application that is hosted in the Website project application <diagram-letter>J</diagram-letter>.

For storing data and performing search queries, the application relies on Amazon DynamoDB <diagram-letter>F</diagram-letter> and Amazon ElasticSearch Service <diagram-letter>G</diagram-letter>, respectively.

#### 5. Form Builder

The Form Builder application doesn't bring any additional cloud infrastructure resources. It just expands the GraphQL schema with its own types and resolvers, so we can say only the GraphQL Server <diagram-letter>C</diagram-letter> Lambda function gets affected by it.

For storing data and performing search queries, the application relies on Amazon DynamoDB <diagram-letter>F</diagram-letter> and Amazon ElasticSearch Service <diagram-letter>G</diagram-letter>, respectively.

#### 6. Headless CMS

Besides expanding the GraphQL schema located on the GraphQL Server <diagram-letter>C</diagram-letter> Lambda function, the Headless CMS application also brings an extra Lambda function which is responsible for hosting the dynamic CMS GraphQL Server <diagram-letter>D</diagram-letter>. Note that on the diagram, it is shown "behind" the GraphQL Server <diagram-letter>C</diagram-letter> Lambda function. Check the Headless CMS diagrams for a better overview.

For storing data and performing search queries, the application relies on Amazon DynamoDB <diagram-letter>F</diagram-letter> and Amazon ElasticSearch Service <diagram-letter>G</diagram-letter>, respectively.

## FAQ

**Why is Webiny using AWS Lambda to host a GraphQL server and not AWS AppSync?**

There are a couple of reason for that.

First, implementing a GraphQL server using AWS Lambda enables us and our users to make additional customizations to server's behaviour.

The default Webiny applications rely on this fact as well. For example, the I18N application gives you the ability to check what is the current locale that the user is on. The Security application gives you the ability to perform custom authentication and authorization checks inside of your resolvers. Finally, it also makes it possible for the Headless CMS application to generate different GraphQL schemas, based on the current I18N locale.

Secondly, you can test your GraphQL server easily with Jest, as you would do with any other JavaScript piece of code.

And finally, this approach makes it much easier for Webiny to be hosted on not just one cloud infrastructure provider (AWS), but on many more, like Microsoft Azure or Google Cloud Platform.

**Which GraphQL implementation are you using?**

We started with [Apollo GraphQL Server](https://www.apollographql.com/docs/apollo-server/), but for Webiny version 5, we migrated to [GraphQL tools](https://www.graphql-tools.com/), because it's more lightweight and both easier to implement and grasp.

**Which Amazon API Gateway is deployed as part of the API application?**

By default, we deploy [HTTP APIs](https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api.html). This can be changed on your behalf, if need be.

**In DynamoDB, how is the data structured?**

Webiny is following an approach called [single-table design](https://www.alexdebrie.com/posts/dynamodb-single-table/), which advocates for storing all the application data into a single DynamoDB table. All of the Webiny applications are storing data in a single table, with appropriate primary and secondary keys in order to avoid clashing of data.

:::info
This doesn't mean you have to do the same. Using [Pulumi](/docs/key-topics/deployment/iac-with-pulumi), you can easily deploy separate DynamoDB tables and structure your application's data in any way you want.
:::

